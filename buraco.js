var ne=Object.create,k=Object.defineProperty,ce=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty,he=Object.getOwnPropertyNames,de=Object.getOwnPropertyDescriptor;var ue=s=>k(s,"__esModule",{value:!0});var U=(s,e)=>()=>(e||(e={exports:{}},s(e.exports,e)),e.exports);var pe=(s,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of he(e))!le.call(s,r)&&r!=="default"&&k(s,r,{get:()=>e[r],enumerable:!(t=de(e,r))||t.enumerable});return s},P=s=>pe(ue(k(s!=null?ne(ce(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);var te=U((M,V)=>{M=V.exports=ge;M.getSerialize=ee;function ge(s,e,t,r){return JSON.stringify(s,ee(e,r),t)}function ee(s,e){var t=[],r=[];return e==null&&(e=function(a,i){return t[0]===i?"[Circular ~]":"[Circular ~."+r.slice(0,t.indexOf(i)).join(".")+"]"}),function(a,i){if(t.length>0){var o=t.indexOf(this);~o?t.splice(o+1):t.push(this),~o?r.splice(o,Infinity,a):r.push(a),~t.indexOf(i)&&(i=e.call(this,a,i))}else t.push(i);return s==null?i:s.call(this,a,i)}}});var L=U((Se,re)=>{"use strict";var ve=te(),ye=function(){var s=4022871197,e=function(t){if(t){t=t.toString();for(var r=0;r<t.length;r++){s+=t.charCodeAt(r);var a=.02519603282416938*s;s=a>>>0,a-=s,a*=s,s=a>>>0,a-=s,s+=a*4294967296}return(s>>>0)*23283064365386963e-26}else s=4022871197};return e},_=function(s){return function(){var e=48,t=1,r=e,a=new Array(e),i,o,p=0,y=new ye;for(i=0;i<e;i++)a[i]=y(Math.random());var B=function(){++r>=e&&(r=0);var n=1768863*a[r]+t*23283064365386963e-26;return a[r]=n-(t=n|0)},u=function(n){return Math.floor(n*(B()+(B()*2097152|0)*11102230246251565e-32))};u.string=function(n){var b,A="";for(b=0;b<n;b++)A+=String.fromCharCode(33+u(94));return A};var oe=function(){var n=Array.prototype.slice.call(arguments);for(i=0;i<n.length;i++)for(o=0;o<e;o++)a[o]-=y(n[i]),a[o]<0&&(a[o]+=1)};return u.cleanString=function(n){return n=n.replace(/(^\s*)|(\s*$)/gi,""),n=n.replace(/[\x00-\x1F]/gi,""),n=n.replace(/\n /,`
`),n},u.hashString=function(n){for(n=u.cleanString(n),y(n),i=0;i<n.length;i++)for(p=n.charCodeAt(i),o=0;o<e;o++)a[o]-=y(p),a[o]<0&&(a[o]+=1)},u.seed=function(n){(typeof n=="undefined"||n===null)&&(n=Math.random()),typeof n!="string"&&(n=ve(n,function(b,A){return typeof A=="function"?A.toString():A})),u.initState(),u.hashString(n)},u.addEntropy=function(){var n=[];for(i=0;i<arguments.length;i++)n.push(arguments[i]);oe(p+++new Date().getTime()+n.join("")+Math.random())},u.initState=function(){for(y(),i=0;i<e;i++)a[i]=y(" ");t=1,r=e},u.done=function(){y=null},typeof s!="undefined"&&u.seed(s),u.range=function(n){return u(n)},u.random=function(){return u(Number.MAX_VALUE-1)/Number.MAX_VALUE},u.floatBetween=function(n,b){return u.random()*(b-n)+n},u.intBetween=function(n,b){return Math.floor(u.random()*(b-n+1))+n},u}()};_.create=function(s){return new _(s)};re.exports=_});var H=P(require("path"));var se=P(require("fs"));var f=s=>`[${s}m`,C={bold:f("1"),black:f("30"),red:f("31"),green:f("32"),yellow:f("33"),blue:f("34"),magenta:f("35"),cyan:f("36"),white:f("37"),gray:f("90"),bgBlack:f("40"),bgRed:f("41"),bgGreen:f("42"),bgYellow:f("43"),bgBlue:f("44"),bgMagenta:f("45"),bgCyan:f("46"),bgWhite:f("47"),bgGray:f("100"),reset:f("0")};function fe(s){return s.endsWith(C.reset)?s:`${s}${C.reset}`}var l=Object.keys(C).reduce((s,e)=>({...s,[e]:t=>fe(`${C[e]}${t}`)}),{});var x="\u2665\u2666\u2663\u2660".split(""),J;(function(s){s[s.Heart=0]="Heart",s[s.Diamonds=1]="Diamonds",s[s.Clubs=2]="Clubs",s[s.Spades=3]="Spades"})(J||(J={}));var D=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],m;(function(s){s[s.Two=0]="Two",s[s.Three=1]="Three",s[s.Four=2]="Four",s[s.Five=3]="Five",s[s.Six=4]="Six",s[s.Seven=5]="Seven",s[s.Eight=6]="Eight",s[s.Nine=7]="Nine",s[s.Ten=8]="Ten",s[s.Jack=9]="Jack",s[s.Queen=10]="Queen",s[s.King=11]="King",s[s.Ace=12]="Ace"})(m||(m={}));var w=class{constructor(e,t){if(typeof e=="string"){let r=x.reduce((o,p)=>e.indexOf(p)>o?e.indexOf(p):o,-1);if(r<0||r>=x.length)throw new Error(`Carta ${e} \xE9 inv\xE1lida: n\xE3o h\xE1 naipe.`);let a=e.substring(0,r),i=e.substring(r);if(this._value=D.findIndex(o=>o===a),this._suit=x.findIndex(o=>o===i),this._value<0||this._value>=D.length)throw new Error(`Carta ${e} \xE9 inv\xE1lida: valor inexistente.`)}else{if(t===void 0)throw new Error("Carta sem naipe associado.");this._value=e,this._suit=t}}get value(){return this._value}get suit(){return this._suit}get str(){return D[this._value]+x[this._suit]}toString(){let e=l.black(D[this._value]),t=this._suit<2?l.red(x[this._suit]):l.black(x[this._suit]);return l.bgWhite(e)+l.bgWhite(t)}};function j(){let s=new $;for(let e=0;e<x.length;e++)for(let t=0;t<D.length;t++)s.push(new w(t,e));return s.shuffle(),s.shuffle(),s}var $=class{constructor(e=[]){this.cards=e}get length(){return this.cards.length}shuffle(){for(let e=this.cards.length-1;e>0;e--){let t=Math.floor(c.random()*(e+1));[this.cards[e],this.cards[t]]=[this.cards[t],this.cards[e]]}}sort(){this.cards.sort((e,t)=>e.suit!=t.suit?e.suit-t.suit:e.value-t.value)}sorted(){let e=this.cards.slice();return e.sort((t,r)=>t.suit!=r.suit?t.suit-r.suit:t.value-r.value),e}get str(){return`[ ${this.cards.map(e=>e.str).join(" ")} ]`}toString(){return`[ ${this.cards.join(" ")} ]`}get top(){return this.cards[this.cards.length-1]}pop(){return this.cards.pop()}push(e){e!==void 0&&this.cards.push(e)}pushCards(e){e.forEach(t=>this.cards.push(t))}indexOf(e){return this.cards.findIndex(t=>t.value===e.value&&t.suit===e.suit)}has(e){return this.indexOf(e)>=0}hasAll(e){return e.every(t=>this.has(t))}remove(e){let t=this.indexOf(e);return t<0?!1:(this.cards.splice(t,1),!0)}removeCards(e){e.forEach(t=>this.remove(t))}clear(){this.cards=[]}merge(e){for(;e.length>0;)this.push(e.pop());return this.shuffle(),this}isMeld(){if(this.cards.length<3||this.cards.length>14)return!1;let e=[],t=[],r=[];this.cards.forEach(i=>{i.value===12?e.push(i):i.value===0?r.push(i):t.push(i)});let a=t.length>0?t[0].suit:e[0].suit;if(t.some(i=>i.suit!==a)||(t.sort((i,o)=>i.suit!=o.suit?i.suit-o.suit:i.value-o.value),r.length>2))return!1;if(r.length===2){if(r[0].suit!==a&&r[1].suit!==a)return!1;let i=r[0].suit===a?0:1;t.unshift(r.splice(i,1)[0])}if(e.length>2)return!1;e.length===2&&t.push(e.pop());for(let i=1;i<t.length;i++){let o=Math.abs(t[i].value-t[i-1].value);if(o===0||o>2)return!1;if(o===2){if(r.length===0)return!1;t.splice(i,0,r.pop()),i++}}if(e.length===1)if(t[0].value===0)t.unshift(e.pop());else if(t[t.length-1].value===11)t.push(e.pop());else if(r.length===1)if(t[0].value===1)t.unshift(r.pop()),t.unshift(e.pop());else if(t[t.length-1].value===10)t.push(r.pop()),t.push(e.pop());else return!1;else return!1;return r.length===1&&t.unshift(r.pop()),this.cards=t,!0}};var O=class{constructor(e=1){this.melds=[],this.playersHands=[new $],e==2&&this.playersHands.push(new $)}getHand(e=0){return this.playersHands[e]}};function W(s,e,t){let r=Math.floor((s-e.length)/2)-1,a=t.repeat(r),i=s-r-e.length-2,o=t.repeat(i),p=l.white(`${a} ${e} ${o}`);console.log(l.bgBlue(p))}function v(s=""){let e=80;console.log();let t=l.white("=".repeat(e)),r=l.bgBlue(t);Array.isArray(s)?(console.log(r),s.forEach(a=>W(e,a," ")),console.log(r)):s.length==0?console.log(r):W(e,s,"="),console.log()}var z=P(require("path")),S=P(require("child_process"));var F=P(require("child_process")),G=P(require("stream")),Y=P(require("readline"));function N(s){let e=(0,Y.createInterface)({input:s}),t=async function*(){for await(let r of e)yield r}();return async()=>(await t.next()).value}function X(s){let e=new G.Readable({read:()=>{}}),t=(0,F.fork)(s);return t.on("message",r=>e.push(r)),{process:t,read:N(e),write:r=>t.send(`${r}
`)}}var Q=P(require("path"));var E=console.log,me=3e3,Z=l.bgGreen(l.black("DEBUG:")),R=class{constructor(e,t){this.id=e;this.execName=t;Q.dirname(t)==="."?this.proc=(0,S.spawn)((0,z.join)(process.cwd(),t)):this.proc=(0,S.spawn)(t),c.silent&&(E=()=>{}),this.proc.on("error",r=>{E(l.red(`Erro na execu\xE7\xE3o do programa ${t}.`)),E(l.red(r)),this.halt()}),this.proc.stderr.on("data",r=>{if(!c.silent){let a=r.toString().replace(/\n/g,`
	`);E(l.red(`Bot ${e}:`)),E(l.red(`	${a}`))}}),this._errorPromise=new Promise(r=>{this.proc.on("close",(a,i)=>{i!=="SIGINT"?(E(l.red(`Programa ${this.execName} terminou com signal ${i}.`)),r("EXEC_ERROR")):r("FINISHED")})}),this._read=N(this.proc.stdout)}write(e){R.debug&&console.debug(`${Z} Enviando para ${this.id}: ${e}`),this.proc.stdin.write(`${e}
`)}async read(){let e,t=new Promise(o=>{e=setTimeout(()=>o("TIMEOUT"),3e3)}),r=this._read(),a=this._errorPromise,i=await Promise.race([t,r,a]).then(o=>o===void 0?"ERROR":o);return i==="TIMEOUT"?(E(`Jogador ${this.id} n\xE3o enviou dados no tempo de ${me}ms e foi eliminado.`),Promise.resolve("PLAYER_ERROR")):i==="ERROR"?(E(`Jogador ${this.id} teve problemas t\xE9cnicos e foi eliminado.`),Promise.resolve("PLAYER_ERROR")):(clearTimeout(e),R.debug&&console.debug(`${Z} Recebido de ${this.id}: ${i}`),Promise.resolve(i))}halt(){this.proc.kill("SIGINT")}},T=R;T.debug=!1;var d;(function(s){s.SETUP="Configura\xE7\xE3o inv\xE1lida.",s.ACTION="A\xE7\xE3o inv\xE1lida.",s.FORMAT="Formato de mensagem inv\xE1lido.",s.CARD="Carta inv\xE1lida.",s.DECK="Sequ\xEAncia de cartas inv\xE1lida.",s.MELD="Jogo inv\xE1lido.",s.FILE="Arquivo inv\xE1lido."})(d||(d={}));var h=console.log,I=l.bgGreen(l.black("DEBUG:")),c=class{constructor(e){this.players=e;if(e.length!==2&&e.length!==4&&this.fail(d.SETUP,"O jogo deve ter dois ou quatro jogadores."),c.silent&&(h=function(){}),c.seed?c.rand=L().create(c.seed):(c.seed=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),c.rand=L().create(c.seed)),h(`Seed da partida ${c.seed}`),this.discardPile=new $,this.stock=j().merge(j()),this.playersPerTeam=e.length/2,this.team0=new O(this.playersPerTeam),this.team1=new O(this.playersPerTeam),c.initFile)this.initFromFile(c.initFile);else{for(let t=0;t<11;t++)for(let r=0;r<this.playersPerTeam;r++)this.team0.getHand(r).push(this.stock.pop()),this.team1.getHand(r).push(this.stock.pop());this.discardPile.push(this.stock.pop()),this.playerIndex=Math.floor(c.random()*2*this.playersPerTeam)}}initFromFile(e){let t=(a,i)=>this.stock.remove(a)&&i.push(a),r=(a,i)=>{a.split(" ").slice(1,-1).map(o=>new w(o)).forEach(o=>t(o,i))};try{let i=(0,se.readFileSync)(e,"utf8").split(`
`).filter(o=>o.length>0);for(let o=0;o<this.playersPerTeam;o++)r(i[2*o+0],this.team0.getHand(o)),r(i[2*o+1],this.team1.getHand(o));t(new w(i[i.length-2]),this.discardPile),this.playerIndex=Number(i[i.length-1])}catch(a){console.error(a),this.closeGame()}}static random(){return this.rand.random()}initialSetup(){h(`O jogo come\xE7a com o jogador ${this.currentPlayerName}.`),h(`A pilha de descarte come\xE7a inicialmente com a carta ${this.discardPile.top}.`);let e=this.players.reduce((t,r)=>t+r.id+" ","").trimEnd();this.players.forEach((t,r)=>{this.send(e,t),this.send(t.id,t),this.send(this.getHand(r).str,t),this.send(this.discardPile.top.str,t)})}closeGame(){this.players.forEach(e=>e.halt()),process.exit()}countPoints(e){let t=0;return e.cards.forEach(r=>{r.value>=m.Three&&r.value<=m.Seven?t+=5:r.value==m.Two||r.value>=m.Eight&&r.value<=m.King?t+=10:t+=15}),e.length>=7&&(t+=e.cards.some((a,i,o)=>{if(a.value!==m.Two)return!1;if(i<0){let p=o[i-1];if(p.value!==m.Ace||p.suit!==a.suit)return!0}if(i<o.length-1){let p=o[i+1];if(p.value!==m.Three||p.suit!==a.suit)return!0}return!1})?100:200),t}countTeamPoints(e){let t=e.melds.reduce((i,o)=>i+this.countPoints(o),0),r=this.countPoints(e.playersHands[0]);r===0&&(r=-100);let a=0;return this.playersPerTeam==2&&(a=this.countPoints(e.playersHands[1]),a===0&&(a=-100)),t-r-a}showPoints(e,t,r,a){e.forEach((i,o)=>h(`${i} tinha na m\xE3o as cartas ${t[o].sorted()}`)),r.length>0?(h("Os seguintes jogos foram baixados:"),r.forEach(i=>h(i.toString()))):h("Nenhum jogo foi baixado."),h(`Total de pontos: ${a} pontos`)}gameOver(e){let t=this.countTeamPoints(this.team0),r=this.countTeamPoints(this.team1),a=this.players[0].color(this.players[0].id),i=this.players[1].color(this.players[1].id);if(c.silent)if(this.playersPerTeam===1)console.log(t===r?`OK ${c.seed} ${t} ${r} empate`:`OK ${c.seed} ${t} ${r} ${t>r?this.players[0].id:this.players[1].id}`);else{let o=t>r?`${this.players[0].id} e ${this.players[2].id}`:`${this.players[1].id} e ${this.players[3].id}`;console.log(t===r?`OK ${c.seed} ${t} ${r} empate`:`OK ${c.seed} ${t} ${r} ${o}`)}else if(v(e),this.playersPerTeam===1)this.showPoints([a],[this.getHand(0)],this.team0.melds,t),v(),this.showPoints([i],[this.getHand(1)],this.team1.melds,r),v(),h(t===r?"Incr\xEDvel! Houve um empate!":`${t>r?a:i} venceu.
`);else{let o=this.players[2].color(this.players[2].id),p=this.players[3].color(this.players[3].id);this.showPoints([a,o],[this.getHand(0),this.getHand(2)],this.team0.melds,t),v(),this.showPoints([i,p],[this.getHand(1),this.getHand(3)],this.team1.melds,r),v();let y=t>r?`${a} e ${o}`:`${i} e ${p}`;h(t===r?"Incr\xEDvel! Houve um empate!":`${y} venceram.
`)}this.closeGame()}async run(){for(;;)this.broadcast(this.currentPlayer.id),await this.firstMove(),await this.secondMove(),this.playerIndex=(this.playerIndex+1)%this.players.length}async firstMove(){let{action:e,args:t}=await this.receiveAction();e==="GET_STOCK"?this.getStock():e==="GET_DISCARD"?(this.getDiscard(t),this.currentHand.cards.length===0&&this.gameOver(`Jogador ${this.currentPlayer.id} bateu.`)):e=="PLAYER_ERROR"?this.fail(d.ACTION,`Algo estranho ocorreu com o jogador ${this.currentPlayer.id}`):this.fail(d.ACTION,`A primeira a\xE7\xE3o deve ser puxar uma carta do monte (GET_STOCK) ou do lixo (GET_DISCARD) e foi enviado ${l.yellow(e)}.`),this.showPlayerState()}async secondMove(){let e;do{switch(e=await this.receiveAction(),e.action){case"MELD_NEW":this.createMeld(e.args);break;case"MELD_JOIN":this.joinMeld(e.args);break;case"DISCARD":this.discard(e.args);break;case"PLAYER_ERROR":this.fail(d.ACTION,`Algo estranho ocorreu com o jogador ${this.currentPlayer.id}`);break;default:this.fail(d.ACTION,`Poss\xEDveis a\xE7\xF5es: MELD_NEW, MELD_JOIN ou DISCARD. A a\xE7\xE3o ${e.action} n\xE3o \xE9 poss\xEDvel.`);break}this.currentHand.cards.length===0&&this.gameOver(`Jogador ${this.currentPlayer.id} bateu.`),this.showPlayerState()}while(e.action!=="DISCARD")}showPlayerState(){T.debug&&(h(`${I} M\xE3o do jogador ${this.currentPlayerName}`),h(`${I} ${this.currentHand.sorted()}`),h(`${I} Jogos do jogador ${this.currentPlayerName}`),this.currentTeam.melds.forEach(e=>h(`${I} ${e}`)))}getStock(){let e=this.stock.pop();e?(this.currentHand.push(e),this.send(e.str),this.broadcastNonCurrent("GET_STOCK"),h(`${this.currentPlayerName} puxou uma carta do deque de compra.`)):this.gameOver("N\xE3o h\xE1 mais cartas para puxar. O jogo terminou.")}getDiscard(e){e.length<2&&this.fail(d.DECK,"\xC9 necess\xE1rio pelo menos duas cartas para se juntar com o topo do lixo.");let t;try{t=e.map(i=>new w(i))}catch(i){this.fail(d.CARD,i)}let r=this.discardPile.pop(),a=new $([r,...t]);this.currentHand.hasAll(t)===!1?this.fail(d.DECK,"Tentativa de forma jogo com cartas que n\xE3o est\xE3o na m\xE3o."):a.isMeld()?(this.currentTeam.melds.push(a),this.send(this.discardPile.str),this.broadcastNonCurrent(`GET_DISCARD [ ${e.join(" ")} ]`),this.currentHand.removeCards(t),this.currentHand.merge(this.discardPile),h(`${this.currentPlayerName} pegou o lixo e fez o jogo ${a}.`)):this.fail(d.MELD,`As cartas ${a} n\xE3o formam um jogo.`)}createMeld(e){let t;try{t=e.map(a=>new w(a))}catch(a){this.fail(d.CARD,a)}let r=new $(t);this.currentHand.hasAll(t)===!1?this.fail(d.DECK,"Tentativa de forma jogo com cartas que n\xE3o est\xE3o na m\xE3o."):r.isMeld()?(this.currentTeam.melds.push(r),this.currentHand.removeCards(t),this.broadcastNonCurrent(`MELD_NEW ${r.str}`),h(`${this.currentPlayerName} baixou o jogo ${r}.`)):this.fail(d.MELD,`As cartas ${r} n\xE3o formam um jogo.`)}joinMeld([e,...t]){let r=Number(e);(r<0||r>=this.currentTeam.melds.length)&&this.fail(d.FORMAT,`O identificador ${e} n\xE3o costa nos jogos da equipe.`),(t[0]!=="["||t[t.length-1]!=="]")&&this.fail(d.FORMAT,"As cartas a serem anexadas ao jogo devem estar entre [ ].");let a;try{a=t.slice(1,-1).map(o=>new w(o))}catch(o){this.fail(d.CARD,o)}let i=this.currentTeam.melds[r];if(i.pushCards(a),this.currentHand.hasAll(a)===!1)this.fail(d.DECK,"Tentativa de forma jogo com cartas que n\xE3o est\xE3o na m\xE3o.");else if(i.isMeld()){this.currentHand.removeCards(a);let o=new $(a);this.broadcastNonCurrent(`MELD_JOIN ${e} ${o.str}`),h(`${this.currentPlayerName} adicionou as cartas ${o.str} atualizando o jogo ${i}.`)}else this.fail(d.MELD,`As cartas ${i} n\xE3o formam um jogo.`)}discard(e){e.length===0&&this.fail(d.FORMAT,"\xC9 necess\xE1rio informar a carta a ser descartada na a\xE7\xE3o DISCARD"),e.length>1&&this.fail(d.FORMAT,"A\xE7\xE3o DISCARD requer um \xFAnico par\xE2metro, a carta a ser descartada");try{let t=new w(e[0]);this.currentHand.has(t)?(this.currentHand.remove(t),this.discardPile.push(t),this.broadcastNonCurrent(`DISCARD ${t.str}`),h(`${this.currentPlayerName} descartou a carta ${t}.`)):this.fail(d.CARD,`O jogador n\xE3o possui a carta ${t}.`)}catch(t){this.fail(d.CARD,t)}}async receive(){return await this.currentPlayer.read()}async receiveAction(){let e=await this.receive(),[t,...r]=e.split(" ").filter(a=>a.length>0);return r[0]==="["&&r[r.length-1]==="]"&&(r=r.slice(1,-1)),{action:t,args:r}}send(e,t=this.currentPlayer){return t.write(e)}broadcast(e,t=this.players){t.forEach(r=>this.send(e,r))}broadcastNonCurrent(e){this.broadcast(e,this.players.filter(t=>t!=this.currentPlayer))}disqualify(e){h(`${e.id}: ${l.red("DESQUALIFICADO")}`);let t=this.countTeamPoints(this.team0),r=this.countTeamPoints(this.team1),a=this.players[0].color(this.players[0].id),i=this.players[1].color(this.players[1].id);if(c.silent)if(this.playersPerTeam===1)console.log(`NOK ${c.seed} ${t} ${r} ${e!==this.players[0]?this.players[0].id:this.players[1].id}`);else{let o=e!==this.players[0]?`${this.players[0].id} e ${this.players[2].id}`:`${this.players[1].id} e ${this.players[3].id}`;console.log(`NOK ${c.seed} ${t} ${r} ${o}`)}else if(v(),this.playersPerTeam===1)this.showPoints([a],[this.getHand(0)],this.team0.melds,t),v(),this.showPoints([i],[this.getHand(1)],this.team1.melds,r),v(),h(`${e!==this.players[0]?a:i} venceu.
`);else{let o=this.players[2].color(this.players[2].id),p=this.players[3].color(this.players[3].id);this.showPoints([a,o],[this.getHand(0),this.getHand(2)],this.team0.melds,t),v(),this.showPoints([i,p],[this.getHand(1),this.getHand(3)],this.team1.melds,r),v();let y=e!==this.players[0]?`${a} e ${o}`:`${i} e ${p}`;h(`${y} venceram.
`)}}fail(e,t){h(`${this.currentPlayerName}: ${l.red(e)} ${t}`),this.disqualify(this.currentPlayer),this.closeGame()}getTeam(e){return e%2==0?this.team0:this.team1}get currentTeam(){return this.getTeam(this.playerIndex)}get oponentTeam(){return this.getTeam(this.playerIndex)===this.team0?this.team1:this.team0}get currentPlayerName(){return this.currentPlayer.color(this.currentPlayer.id)}get currentPlayer(){return this.players[this.playerIndex]}get currentHand(){return this.getHand(this.playerIndex)}getHand(e){return this.getTeam(e).getHand(e<2?0:1)}};var ie=P(require("path"));var K=class{constructor(e){this.id="user";this.id=e,this.child=X((0,ie.join)(__dirname,e))}write(e){this.child.write(`${e}`)}async read(){return await this.child.read()}halt(){this.child.process.kill("SIGINT")}};var q=console.log,$e=[l.cyan,l.yellow,l.magenta,l.cyan];function ae(){let s=H.basename(process.argv[0]),e=H.basename(process.argv[1]);v(["Buraco"]),q(`
    Neste jogo, bots competem entre si numa partida de Buraco simplificada.
    Pode-se colocar de 1 at\xE9 4 bots para competir, especificando o caminho de
    seus execut\xE1veis na linha de comando.
    Caso haja um n\xFAmero \xEDmpar de bots, o usu\xE1rio ser\xE1 um dos jogadores
    completando as equipes.
    `),q(`Uso: ${s} ${e} [-h] [-d] [-i <arquivo>] [-seed <inteiro>] [-silent] bot1 [bot2 [bot3 [bot4]]]`),q(`
    -h: (help) Explica os par\xE2metros de linha de comando (esta ajuda).
    -d: (debug) Imprime as trocas de mensagens entre o jogo e os bots.
    -i: Inicia a partida com as cartas descritas no arquivo especificado (para testar estrat\xE9gias).
    bot1, bot2...: caminho para os execut\xE1veis dos bots.
    -seed: Executa o bot com uma seed espec\xEDfica, ex: -seed 1002
    -silent: Executa o embate e mostra apenas o resultado ao fim do jogo
    `)}async function Pe(){let s=process.argv.slice(2).filter(r=>!r.startsWith("-")),e=[],t=s.length;if(t<1||t>4)ae();else{t%2&&e.push(new K("user"));for(let r=0;r<t;r++){let a=s[r],i=`p${r+1}.${H.basename(a)}`;e.push(new T(i,a))}}return e.forEach((r,a)=>r.color=$e[a]),e}async function we(){let s=await Pe();c.silent||v(["BURACO",`Jogadores : ${s.map(t=>t.id).join(", ")}`]);let e=new c(s);try{e.initialSetup(),await e.run()}catch(t){console.error(t),s.forEach(r=>r.halt())}}var g=process.argv.indexOf("-d");g>1&&(T.debug=!0,process.argv.splice(g,1));g=process.argv.indexOf("-i");g>1&&g<process.argv.length-1&&(c.initFile=process.argv[g+1],process.argv.splice(g,2));g=process.argv.indexOf("-seed");g>1&&g<process.argv.length-1&&(c.seed=parseInt(process.argv[g+1]),process.argv.splice(g,2));g=process.argv.indexOf("-silent");g>1&&(c.silent=!T.debug,process.argv.splice(g,1));process.argv.includes("-h")||process.argv.length<3?ae():we();
